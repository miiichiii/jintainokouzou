<!DOCTYPE html>
<html lang="ja">
<head>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@700&display=swap" rel="stylesheet">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç¬¬ï¼‘å›ç¢ºèªãƒ†ã‚¹ãƒˆï¼ˆäººä½“ã®æ§‹é€ ï¼‰- GSAPã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ã</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      line-height: 1.6;
      color: #333;
      background: linear-gradient(135deg, #a8edea, #fed6e3);
      background-size: cover;
      background-repeat: no-repeat;
      background-attachment: fixed;
      padding: 20px;
      margin: 0;
      overflow-x: hidden; /* GSAPã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é˜²æ­¢ */
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    h1, h2 {
      font-family: 'Noto Sans JP', sans-serif;
      font-weight: 700;
    }
    .quiz-container, .result-card {
      background-color: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      margin-bottom: 20px;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    .question {
      font-size: 1.3em;
      margin-bottom: 20px;
      color: #1d1d1f;
    }
    .options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }
    .option {
      background-color: rgba(255, 255, 255, 0.7);
      border: none;
      border-radius: 16px;
      padding: 15px;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.3s ease 0.1s, transform 0.3s ease;
      text-align: center;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    .option:hover {
      background: linear-gradient(135deg, #a8edea, #fed6e3);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }
    .option.selected {
      /* é¸æŠæ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ«ã¯ç¶­æŒã—ã¤ã¤ã€æ­£è§£/ä¸æ­£è§£ã§ä¸Šæ›¸ãã•ã‚Œã‚‹ */
    }
    .option.disabled {
      /* pointer-events: none; ã¯GSAPã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ç«¶åˆã™ã‚‹å ´åˆãŒã‚ã‚‹ã®ã§æ³¨æ„ */
      /* ã‚¯ãƒªãƒƒã‚¯åˆ¶å¾¡ã¯JSã§è¡Œã† */
      opacity: 0.7; /* ç„¡åŠ¹åŒ–ã‚’è¦–è¦šçš„ã«ç¤ºã™ */
    }
    /* æ­£è§£æ™‚ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
    .option.correct {
      background: linear-gradient(135deg, #34c759, #a8e6cf);
      color: #fff;
      transform: scale(1.02); /* æ­£è§£æ™‚ã«å°‘ã—æ‹¡å¤§ */
    }
    /* ä¸æ­£è§£æ™‚ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
    .option.incorrect {
      background: linear-gradient(135deg, #ff3b30, #ff9a8b);
      color: #fff;
      /* æºã‚Œã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¯GSAPã§è¡Œã† */
    }
    .option::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.1);
      opacity: 0;
      transition: opacity 0.3s;
    }
    .option:active::after {
      transform: scale(0.98);
    }
    .explanation {
      margin-top: 20px;
      font-size: 1em;
      color: #333;
      background-color: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      border-left: 5px solid #4caf50;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      /* GSAPã§åˆ¶å¾¡ã™ã‚‹ãŸã‚åˆæœŸéè¡¨ç¤º */
      display: none;
      opacity: 0;
    }
    .explanation-header {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      font-weight: bold;
      color: #4caf50;
    }
    .explanation-icon {
      font-size: 1.5em;
      margin-right: 10px;
    }
    .nav-button {
      background: linear-gradient(135deg, #007aff, #5ac8fa);
      color: #fff;
      border: none;
      border-radius: 12px;
      padding: 12px 24px;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease; /* box-shadow transitionè¿½åŠ  */
      margin-top: 20px;
      width: 100%;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    .nav-button:hover {
      background: linear-gradient(135deg, #005bb5, #4aa0d3);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }
    .nav-button:active {
      transform: scale(0.98);
    }
    .result-card {
      margin-bottom: 20px;
      /* GSAPã§åˆ¶å¾¡ã™ã‚‹ãŸã‚åˆæœŸé€æ˜åŒ– */
      opacity: 0;
    }
    .result-card h3 {
      font-size: 1.2em;
      margin-bottom: 10px;
    }
    .result-status {
      font-weight: bold;
      margin-bottom: 10px;
    }
    .correct {
      color: #34c759;
    }
    .incorrect {
      color: #ff3b30;
    }
    #attendance-link {
      background-color: #34c759;
      color: white;
      padding: 15px;
      border-radius: 12px;
      margin-top: 20px;
      text-align: center;
      /* GSAPã§åˆ¶å¾¡ã™ã‚‹ãŸã‚åˆæœŸéè¡¨ç¤º */
      display: none;
      opacity: 0;
    }
    #attendance-link a {
      color: white;
      text-decoration: none;
      font-weight: bold;
    }
    #attendance-link a:hover {
      text-decoration: underline;
    }
  </style>

  <!-- GSAPãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ (æœ€æ–°ç‰ˆã‚’æ¨å¥¨) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

</head>
<body>
  <div class="container">
    <h1 style="text-align: center;">ç¬¬ï¼‘å›ç¢ºèªãƒ†ã‚¹ãƒˆï¼ˆäººä½“ã®æ§‹é€ ï¼‰</h1>
    <div id="quiz-container" class="quiz-container">
      <div id="quiz-content">
        <div id="question" class="question"></div>
        <div id="options" class="options"></div>
        <div id="explanation" class="explanation"></div>
      </div>
      <button id="next" class="nav-button" onclick="nextQuestion()">æ¬¡ã®å•é¡Œ</button>
    </div>
    <div id="result-container"></div>
    <div id="attendance-link"></div>
  </div>


  <script>
    const quizData = [
      // (æ—¢å­˜ã®quizDataã¯å¤‰æ›´ãªã—)
      {
        "question": "è§£å‰–å­¦ã§åŸºæº–ã¨ãªã‚‹ã€æ°—ã‚’ã¤ã‘ã®å§¿å‹¢ã§ç«‹ã¡ã€æ‰‹ã®ã²ã‚‰ã‚’å‰ã«å‘ã‘ãŸä½“ä½ã‚’ä½•ã¨å‘¼ã³ã¾ã™ã‹ï¼Ÿ",
        "options": [
          "ç”Ÿç†å­¦çš„ç«‹ä½",
          "è§£å‰–å­¦çš„æ­£ä½",
          "æ©Ÿèƒ½çš„è‚¢ä½",
          "æ—¥å¸¸çš„ç«‹ä½"
        ],
        "answer": 1,
        "explanation": "äººä½“ã‚’è¨˜è¼‰ãƒ»èª¬æ˜ã™ã‚‹éš›ã®åŸºæº–ã¨ãªã‚‹å§¿å‹¢ã¯ã€Œè§£å‰–å­¦çš„æ­£ä½ã€ã§ã™ã€‚"
      },
      {
        "question": "äººä½“ã‚’å·¦å³ã«åˆ†ã‘ã‚‹é¢ï¼ˆèº«ä½“ã®æ­£ä¸­ã‚’é€šã‚‹é¢ã‚’å«ã‚€ï¼‰ã‚’ä½•ã¨å‘¼ã³ã¾ã™ã‹ï¼Ÿ",
        "options": [
          "æ°´å¹³é¢",
          "å‰é¡é¢ï¼ˆå† çŠ¶é¢ï¼‰",
          "çŸ¢çŠ¶é¢",
          "æ–œæ–­é¢"
        ],
        "answer": 2,
        "explanation": "äººä½“ã‚’å·¦å³ã«åˆ†ã‘ã‚‹é¢ã¯ã€ŒçŸ¢çŠ¶é¢ã€ã§ã™ã€‚ç‰¹ã«æ­£ä¸­ã‚’é€šã‚‹é¢ã¯ã€Œæ­£ä¸­é¢ã€ã¨ã‚‚å‘¼ã°ã‚Œã¾ã™ã€‚"
      },
      {
        "question": "äººä½“ã‚’æ§‹æˆã™ã‚‹ãƒ¬ãƒ™ãƒ«ã§ã€åŒã˜ã‚ˆã†ãªå½¢æ…‹ã¨æ©Ÿèƒ½ã‚’æŒã¤ç´°èƒãŒé›†ã¾ã£ã¦ã§ãã‚‹ã‚‚ã®ã‚’ä½•ã¨å‘¼ã³ã¾ã™ã‹ï¼Ÿ",
        "options": [
          "å™¨å®˜",
          "å€‹ä½“",
          "ç´°èƒ",
          "çµ„ç¹”"
        ],
        "answer": 3,
        "explanation": "ç´°èƒãŒé›†ã¾ã£ã¦ã€Œçµ„ç¹”ã€ã‚’å½¢æˆã—ã¾ã™ã€‚çµ„ç¹”ãŒé›†ã¾ã£ã¦å™¨å®˜ã€å™¨å®˜ãŒé›†ã¾ã£ã¦å™¨å®˜ç³»ã€ãã—ã¦å€‹ä½“ãŒæ§‹æˆã•ã‚Œã¾ã™ã€‚"
      },
      {
        "question": "ä½“ã®è¡¨é¢ã‚„ã€æ¶ˆåŒ–ç®¡ãƒ»æ°—ç®¡ãªã©ã®ç®¡ã®å†…å´ã‚’ãŠãŠã£ã¦ã„ã‚‹ã€ç´°èƒãŒå¯†ã«é›†ã¾ã£ãŸçµ„ç¹”ã¯ä½•ã§ã™ã‹ï¼Ÿ",
        "options": [
          "ç­‹çµ„ç¹”",
          "çµåˆçµ„ç¹”",
          "ä¸Šçš®çµ„ç¹”",
          "ç¥çµŒçµ„ç¹”"
        ],
        "answer": 2,
        "explanation": "ä½“ã®è¡¨é¢ã‚„ä½“å†…ã®ç®¡ã®å†…é¢ã‚’è¦†ã„ã€ä¿è­·ãƒ»å¸åãƒ»åˆ†æ³Œãªã©ã®å½¹å‰²ã‚’æ‹…ã†ã®ã¯ã€Œä¸Šçš®çµ„ç¹”ã€ã§ã™ã€‚ç´°èƒãŒå¯†ã«é…åˆ—ã—ã¦ã„ã‚‹ã®ãŒç‰¹å¾´ã§ã™ã€‚"
      },
      {
        "question": "ä¸Šçš®çµ„ç¹”ã«ãŠã„ã¦ã€ä½“è¡¨ã‚„ç®¡è…”ã«é¢ã—ã¦ã„ã‚‹å´ã®è¡¨é¢ã‚’ä½•ã¨å‘¼ã³ã¾ã™ã‹ï¼Ÿ",
        "options": [
          "åŸºåº•é¢",
          "å´é¢",
          "è‡ªç”±é¢",
          "æ¥ç€é¢"
        ],
        "answer": 2,
        "explanation": "ä¸Šçš®ç´°èƒã®ã€ä½“å¤–ã‚„ä½“å†…ã®ç©ºé–“ï¼ˆç®¡è…”ï¼‰ã«é¢ã—ã¦ã„ã‚‹å´ã‚’ã€Œè‡ªç”±é¢ã€ã¨å‘¼ã³ã¾ã™ã€‚"
      }
    ];

    let currentQuestion = 0;
    let score = 0;
    let userAnswers = [];
    let shuffledOptions = [];
    let isAnimating = false; // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä¸­ã®é€£ç¶šã‚¯ãƒªãƒƒã‚¯é˜²æ­¢ç”¨ãƒ•ãƒ©ã‚°

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    // GSAP: å•é¡Œã¨é¸æŠè‚¢ã®è¡¨ç¤ºã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    function loadQuestion() {
      const questionData = quizData[currentQuestion];
      const questionEl = document.getElementById('question');
      const optionsEl = document.getElementById('options');
      const explanationEl = document.getElementById('explanation');
      const nextButton = document.getElementById('next');

      // ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
      nextButton.disabled = false;
      gsap.to(nextButton, { opacity: 1, duration: 0.2 });


      // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã«åˆæœŸçŠ¶æ…‹ã‚’è¨­å®š
      gsap.set([questionEl, optionsEl], { opacity: 0 });
      gsap.set(explanationEl, { display: 'none', opacity: 0 }); // è§£èª¬ã‚‚ãƒªã‚»ãƒƒãƒˆ

      questionEl.textContent = questionData.question;

      shuffledOptions = shuffleArray([...questionData.options]);
      const optionsHtml = shuffledOptions.map((option, index) => `
        <div class="option" onclick="selectOption(${index})">${option}</div>
      `).join('');

      optionsEl.innerHTML = optionsHtml;

      // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã‚’ä½œæˆ
      const tl = gsap.timeline();
      tl.to(questionEl, { duration: 0.5, opacity: 1, y: 0, delay: 0.2 })
        .fromTo(".option",
          { opacity: 0, y: 20 }, // é–‹å§‹çŠ¶æ…‹
          {
            duration: 0.4,
            opacity: 1,
            y: 0, // çµ‚äº†çŠ¶æ…‹
            stagger: 0.1, // 0.1ç§’ãšã¤é…å»¶
            ease: "power2.out" // ã‚¤ãƒ¼ã‚¸ãƒ³ã‚°è¿½åŠ 
          }, "-=0.2"); // å‰ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¨å°‘ã—é‡ã­ã‚‹
    }

    // GSAP: é¸æŠè‚¢é¸æŠæ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¨è§£èª¬è¡¨ç¤º
    function selectOption(index) {
      if (isAnimating) return; // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä¸­ã¯å‡¦ç†ã—ãªã„

      const options = document.querySelectorAll('.option');
      // é¸æŠè‚¢ãŒã™ã§ã«ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ (disabledã‚¯ãƒ©ã‚¹ã¯ä½¿ã‚ãªã„æ–¹å‘ã§)
      if (options[index].style.pointerEvents === 'none') {
          return;
      }


      isAnimating = true; // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹

      // ã™ã¹ã¦ã®é¸æŠè‚¢ã‚’ã‚¯ãƒªãƒƒã‚¯ä¸å¯ã«
      options.forEach(option => {
        // option.classList.add('disabled'); // CSSã‚¯ãƒ©ã‚¹ã§ã¯ãªãGSAPã§åˆ¶å¾¡
        gsap.to(option, { opacity: 0.7, pointerEvents: 'none', duration: 0.3 });
      });

      // é¸æŠã—ãŸé¸æŠè‚¢ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆï¼ˆã‚¯ãƒªãƒƒã‚¯ä¸å¯ã«ã—ã¤ã¤ã€è¦‹ãŸç›®ã¯å¤‰ãˆã‚‹ï¼‰
      gsap.to(options[index], { opacity: 1, pointerEvents: 'none', duration: 0.3 });
      options[index].classList.add('selected'); // selectedã‚¯ãƒ©ã‚¹ã¯çŠ¶æ…‹ç®¡ç†ç”¨ã«æ®‹ã™

      const question = quizData[currentQuestion];
      const selectedAnswerText = shuffledOptions[index];
      const selectedAnswerIndex = question.options.indexOf(selectedAnswerText);
      userAnswers[currentQuestion] = selectedAnswerIndex;

      const explanationEl = document.getElementById('explanation');
      explanationEl.innerHTML = `
        <div class="explanation-header">
          <span class="explanation-icon">ğŸ’¡</span>
          è§£èª¬
        </div>
        ${question.explanation}
      `;

      // æ­£è§£ãƒ»ä¸æ­£è§£ã®åˆ¤å®šã¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
      const isCorrect = selectedAnswerIndex === question.answer;
      const selectedOptionEl = options[index];

      // é¸æŠè‚¢ã¸ã®ã‚¯ãƒ©ã‚¹ä»˜ä¸ã‚’å°‘ã—é…ã‚‰ã›ã‚‹
      gsap.delayedCall(0.1, () => {
          if (isCorrect) {
              selectedOptionEl.classList.add('correct');
              explanationEl.style.backgroundColor = '#e8f5e9';
              explanationEl.style.borderLeftColor = '#4caf50';
              // æ­£è§£ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ (å°‘ã—ãƒã‚¦ãƒ³ãƒ‰)
              gsap.fromTo(selectedOptionEl, { scale: 1 }, { scale: 1.05, duration: 0.3, ease: "elastic.out(1, 0.5)", yoyo: true, repeat: 1 });
          } else {
              selectedOptionEl.classList.add('incorrect');
              explanationEl.style.backgroundColor = '#ffebee';
              explanationEl.style.borderLeftColor = '#f44336';
              // ä¸æ­£è§£ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ (å·¦å³ã«æºã‚Œã‚‹)
              gsap.fromTo(selectedOptionEl, { x: 0 }, { duration: 0.1, x: 10, ease: "power1.inOut", repeat: 5, yoyo: true });

              // æ­£è§£ã®é¸æŠè‚¢ã‚‚ãƒã‚¤ãƒ©ã‚¤ãƒˆ (ä»»æ„)
              const correctOptionIndex = shuffledOptions.findIndex(opt => opt === question.options[question.answer]);
              if (correctOptionIndex !== -1) {
                  gsap.to(options[correctOptionIndex], { opacity: 1, duration: 0.3 }); // ä¸é€æ˜ã«æˆ»ã™
                  options[correctOptionIndex].classList.add('correct'); // æ­£è§£ã‚¹ã‚¿ã‚¤ãƒ«é©ç”¨
              }
          }
      });


      // è§£èª¬ã®è¡¨ç¤ºã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
      gsap.set(explanationEl, { display: 'block' }); // ã¾ãšè¡¨ç¤º
      gsap.fromTo(explanationEl,
        { opacity: 0, y: 10 }, // é–‹å§‹çŠ¶æ…‹
        {
          duration: 0.5,
          opacity: 1,
          y: 0, // çµ‚äº†çŠ¶æ…‹
          delay: 0.5, // é¸æŠè‚¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã«é–‹å§‹
          onComplete: () => { isAnimating = false; } // è§£èª¬è¡¨ç¤ºå®Œäº†ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†
        }
      );
    }

    // æ¬¡ã®å•é¡Œã¸ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è€ƒæ…®ï¼‰
    function nextQuestion() {
      if (isAnimating) return; // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä¸­ã¯å‡¦ç†ã—ãªã„

       // é¸æŠè‚¢ãŒé¸æŠã•ã‚Œã¦ã„ãªã„å ´åˆã®ã‚¢ãƒ©ãƒ¼ãƒˆ
      const selectedOption = document.querySelector('.option.selected');
       if (!selectedOption && currentQuestion < quizData.length) { // çµæœè¡¨ç¤ºå‰ã®ã¿ãƒã‚§ãƒƒã‚¯
           alert('é¸æŠè‚¢ã‚’é¸ã‚“ã§ãã ã•ã„');
           return;
       }

       // æ¬¡ã®å•é¡ŒãŒã‚ã‚‹å ´åˆ
      if (currentQuestion < quizData.length - 1) {
        isAnimating = true; // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
        const tl = gsap.timeline({ onComplete: () => { isAnimating = false; } }); // å®Œäº†æ™‚ã«ãƒ•ãƒ©ã‚°è§£é™¤
        // ç¾åœ¨ã®å•é¡Œã‚’ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆ
        tl.to("#quiz-content > *", { // å•é¡Œã€é¸æŠè‚¢ã€è§£èª¬ã‚’å¯¾è±¡
          duration: 0.3,
          opacity: 0,
          y: -20,
          stagger: 0.1,
          ease: "power1.in"
        })
        .call(() => { // ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆå®Œäº†å¾Œ
          currentQuestion++;
          loadQuestion(); // æ¬¡ã®å•é¡Œã‚’ãƒ­ãƒ¼ãƒ‰ï¼ˆå†…éƒ¨ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹ï¼‰
        });
      } else {
        // çµæœè¡¨ç¤ºã¸
        showResult();
      }
    }

    // GSAP: çµæœè¡¨ç¤ºã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    function showResult() {
       if (isAnimating) return;
       isAnimating = true; // çµæœè¡¨ç¤ºã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹

      score = userAnswers.reduce((total, answer, index) =>
        total + (answer === quizData[index].answer ? 1 : 0), 0);

      const resultContainer = document.getElementById('result-container');
      const quizContainer = document.getElementById('quiz-container');
      const attendanceLink = document.getElementById('attendance-link'); // å…ˆã«å–å¾—

      // ã‚¯ã‚¤ã‚ºã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆ & çµæœã‚³ãƒ³ãƒ†ãƒŠæº–å‚™
      gsap.to(quizContainer, {
        duration: 0.5,
        opacity: 0,
        y: -30,
        ease: "power1.in",
        onComplete: () => {
          quizContainer.style.display = 'none'; // éè¡¨ç¤ºã«

          const percentage = (score / quizData.length) * 100;
          let resultHtml = `
            <h2 style="opacity: 0;">ã‚¯ã‚¤ã‚ºçµæœ</h2>
            <p style="opacity: 0;">æ­£è§£æ•°: ${score} / ${quizData.length}</p>
            <p style="opacity: 0;">æ­£ç­”ç‡: ${percentage.toFixed(2)}%</p>
          `;

          quizData.forEach((question, index) => {
            const isCorrect = userAnswers[index] === question.answer;
            // å„ã‚«ãƒ¼ãƒ‰ã«åˆæœŸã‚¹ã‚¿ã‚¤ãƒ«é©ç”¨ (JSå´ã§ã‚‚opacity:0ã‚’æŒ‡å®š)
            resultHtml += `
              <div class="result-card" style="opacity: 0; transform: translateY(20px);">
                <h3>å•é¡Œ ${index + 1}</h3>
                <p class="result-status ${isCorrect ? 'correct' : 'incorrect'}">
                  ${isCorrect ? 'æ­£è§£' : 'ä¸æ­£è§£'}
                </p>
                <p><strong>è³ªå•:</strong> ${question.question}</p>
                <p><strong>ã‚ãªãŸã®å›ç­”:</strong> ${shuffledOptions[userAnswers[index]] || 'æœªå›ç­”'}</p> <!-- ä¿®æ­£ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠã—ãŸé¸æŠè‚¢ã‚’è¡¨ç¤º -->
                <p><strong>æ­£è§£:</strong> ${question.options[question.answer]}</p>
                <p><strong>èª¬æ˜:</strong> ${question.explanation}</p>
              </div>
            `;
          });

          resultHtml += `<button class="nav-button" style="opacity: 0; transform: translateY(20px);" onclick="restartQuiz()">ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹</button>`;
          resultContainer.innerHTML = resultHtml;
          resultContainer.style.display = 'block'; // çµæœã‚³ãƒ³ãƒ†ãƒŠã‚’è¡¨ç¤ºå¯èƒ½ã«

          // çµæœãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
          gsap.to("#result-container h2, #result-container p", {
              duration: 0.5,
              opacity: 1,
              stagger: 0.1,
              delay: 0.2
          });

          // å„çµæœã‚«ãƒ¼ãƒ‰ã¨å†æŒ‘æˆ¦ãƒœã‚¿ãƒ³ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
          gsap.to(".result-card, #result-container .nav-button", {
            duration: 0.6,
            opacity: 1,
            y: 0, // translateY(0)ã«æˆ»ã™
            stagger: 0.15,
            ease: "power2.out",
            delay: 0.5, // ãƒ˜ãƒƒãƒ€ãƒ¼è¡¨ç¤ºå¾Œ
            onComplete: () => { // å…¨ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºå®Œäº†å¾Œ
                isAnimating = false; // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†
            }
          });

          // å…¨å•æ­£è§£æ™‚ã®ãƒªãƒ³ã‚¯è¡¨ç¤ºã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
          if (percentage === 100) {
            attendanceLink.innerHTML = `
              <p>ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼å…¨å•æ­£è§£ã§ã™ã€‚</p>
              <a href="https://forms.gle/mHawecVCsxB6CHFC8" target="_blank">å‡ºå¸­ç¢ºèªãƒ•ã‚©ãƒ¼ãƒ ã«å›ç­”ã™ã‚‹</a>
            `;
            gsap.set(attendanceLink, { display: 'block' }); // è¡¨ç¤º
            gsap.to(attendanceLink, {
              duration: 0.5,
              opacity: 1,
              y: 0,
              delay: 1.0 // ä»–ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†ã‚’å¾…ã¤
            });
          }
        }
      });
    }

    // ã‚¯ã‚¤ã‚ºã‚’ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ
    function restartQuiz() {
      if (isAnimating) return;

      currentQuestion = 0;
      score = 0;
      userAnswers = [];
      shuffledOptions = [];

      const resultContainer = document.getElementById('result-container');
      const quizContainer = document.getElementById('quiz-container');
      const attendanceLink = document.getElementById('attendance-link');

      isAnimating = true; // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹

       // çµæœã‚³ãƒ³ãƒ†ãƒŠã¨å‡ºå¸­ãƒªãƒ³ã‚¯ã‚’ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆ
      gsap.to([resultContainer, attendanceLink], {
          duration: 0.4,
          opacity: 0,
          y: -20,
          ease: "power1.in",
          onComplete: () => {
              resultContainer.innerHTML = ''; // å†…å®¹ã‚¯ãƒªã‚¢
              resultContainer.style.display = 'none'; // éè¡¨ç¤º
              attendanceLink.style.display = 'none'; // éè¡¨ç¤º
              attendanceLink.style.opacity = 0; // opacityãƒªã‚»ãƒƒãƒˆ

              // ã‚¯ã‚¤ã‚ºã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³è¡¨ç¤º
              gsap.set(quizContainer, { display: 'block', opacity: 0, y: 20 }); // åˆæœŸçŠ¶æ…‹
              gsap.to(quizContainer, {
                  duration: 0.5,
                  opacity: 1,
                  y: 0,
                  ease: "power2.out",
                  onComplete: () => {
                      isAnimating = false; // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†
                      loadQuestion(); // æœ€åˆã®å•é¡Œã‚’ãƒ­ãƒ¼ãƒ‰ï¼†è¡¨ç¤ºã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
                  }
              });
          }
      });
    }

    // åˆæœŸãƒ­ãƒ¼ãƒ‰
    loadQuestion();
  </script>
</body>
</html>
